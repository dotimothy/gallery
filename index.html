<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery Template</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üì∑</text></svg>">
    <link href='https://fonts.googleapis.com/css?family=Roboto:300,400,900' rel='stylesheet' type='text/css'>

    <!-- External Libs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <!-- App CSS -->
    <link rel="stylesheet" href="css/style.css?v=2">
</head>

<body>

    <!-- UI Layer (Always on top) -->
    <div id="ui-layer">
        <!-- Loading Screen -->
        <div id="loading-screen">
            <div class="spinner"></div>
            <div id="loading-text">Loading Gallery... 0%</div>
            <div id="loading-bar-container">
                <div id="loading-bar"></div>
            </div>
            <div id="loading-stats" style="margin-top: 10px; color: #888; font-size: 0.9em; text-align: center;">
                <div id="loading-file">Initializing...</div>
                <div>
                    <span id="loading-data">0.00 MB</span> |
                    <span id="loading-speed">0 KB/s</span>
                </div>
            </div>
        </div>

        <h1 id="title"></h1>
        <div id="fps-counter"
            style="position: fixed; top: 10px; left: 10px; font-size: 0.8em; opacity: 0.7; z-index: 100; font-family: monospace;">
            FPS: 60</div>


        <!-- Toggle Switch -->
        <!-- Toggle Switch & Controls -->
        <div id="controls-container">
            <button id="controls-toggle" title="Menu" aria-label="Toggle Menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="icon-menu">
                    <path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="icon-close hidden">
                    <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
            </button>

            <div id="controls-list">
                <button id="refresh" title="Reload Gallery">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M23 4v6h-6M1 20v-6h6" />
                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15" />
                    </svg>
                </button>
                <button id="toggleSettings" title="Settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </button>
                <button id="global-fullscreen" title="Go Fullscreen">
                    <svg class="icon-expand" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path
                            d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" />
                    </svg>
                    <svg class="icon-compress hidden" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path
                            d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3" />
                    </svg>
                </button>
                <button id="mode-toggle" class="text-btn">3D</button>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="hidden">
            <div class="settings-content">
                <div class="settings-header">
                    <h2>Gallery Settings</h2>
                    <button id="closeSettings">‚úñÔ∏è</button>
                </div>

                <div class="setting-group" id="group-3d">
                    <h3>3D Experience</h3>
                    <label>
                        <span>Resolution Quality</span>
                        <input type="range" id="set-resolution" min="0.25" max="3.0" step="0.25" value="1.0">
                        <span class="val-display" id="disp-resolution">1.0x</span>
                    </label>
                    <label>
                        <span>Sphere Scale</span>
                        <input type="range" id="set-sphere" min="1.0" max="15.0" step="0.5" value="2.0">
                        <span class="val-display" id="disp-sphere">2.0</span>
                    </label>
                    <label>
                        <span>Star Count</span>
                        <input type="range" id="set-particles" min="0" max="100000" step="1000" value="50000">
                        <span class="val-display" id="disp-particles">50000</span>
                    </label>
                </div>

                <div class="setting-group" id="group-controls">
                    <h3>Controls</h3>
                    <label>
                        <span>Touch Sensitivity</span>
                        <input type="range" id="set-sensitivity" min="1.0" max="10.0" step="0.5" value="1.0">
                        <span class="val-display" id="disp-sensitivity">1.0x</span>
                    </label>
                </div>

                <div class="setting-group">
                    <h3>Slideshow</h3>
                    <label>
                        <span>Interval (sec)</span>
                        <input type="range" id="set-interval" min="1" max="10" step="0.5" value="3.0">
                        <span class="val-display" id="disp-interval">3.0s</span>
                    </label>
                </div>

                <div class="setting-group" id="group-2d">
                    <h3>2D Layout</h3>
                    <label>
                        <span>Images per Row</span>
                        <input type="range" id="set-grid" min="1" max="10" step="1" value="4">
                        <span class="val-display" id="disp-grid">4</span>
                    </label>
                </div>

                <div class="settings-footer">
                    <button id="resetSettings" class="btn-danger">Reset to Defaults</button>
                </div>
            </div>
        </div>

        <!-- Home / Footer -->
        <footer>
            <h2>¬© <a href="https://timothydo.me/photography" target="_blank">TheDoShoots</a> 2026. By Timothy Do. <a
                    href="#" id="openLicense">All Rights Reserved</a>. <a href="https://github.com/dotimothy/gallery"
                    target="_blank">GitHub</a>.</h2>
        </footer>
    </div>

    <!-- Navigation Hints / Arrows (Moved to root to ensure correct Z-Index stacking over viewer) -->
    <button id="leftArrow" class="nav-arrow">‚ùÆ</button>
    <button id="rightArrow" class="nav-arrow">‚ùØ</button>

    <!-- 3D View Container -->
    <div id="gallery-3d"></div>

    <!-- 2D View Container -->
    <div id="gallery-2d"></div>

    <!-- 2D Fullscreen Viewer Overlay (classic behavior) -->
    <div id="imageViewer" hidden>
        <!-- Controls Container -->
        <!-- Controls Container -->
        <div id="viewer-controls-container">
            <button id="viewer-controls-toggle" title="Viewer Menu" aria-label="Toggle Viewer Menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="icon-menu">
                    <path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="icon-close hidden">
                    <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
            </button>
            <div id="viewer-controls-list">
                <button id="exitViewer" title="Close Viewer">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6L18 18" />
                    </svg>
                </button>
                <button id="fullscreenToggle" title="Fullscreen">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" />
                    </svg>
                </button>
                <button id="zoomBtn" title="Zoom / Magnify">
                    <svg class="icon-zoom" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        <line x1="11" y1="8" x2="11" y2="14"></line>
                        <line x1="8" y1="11" x2="14" y2="11"></line>
                    </svg>
                    <svg class="icon-back hidden" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7" />
                    </svg>
                </button>
                <button id="toggleMetadata" title="Info">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <circle cx="12" cy="8" r="2" fill="currentColor" stroke="none"></circle>
                    </svg>
                </button>
                <button id="viewer-slideshow" title="Toggle Slideshow">
                    <svg class="icon-play" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                    <svg class="icon-pause hidden" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <rect x="6" y="4" width="4" height="16"></rect>
                        <rect x="14" y="4" width="4" height="16"></rect>
                    </svg>
                </button>
                <button id="toggleThumbs" title="Toggle Palette">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"></rect>
                        <rect x="14" y="3" width="7" height="7"></rect>
                        <rect x="14" y="14" width="7" height="7"></rect>
                        <rect x="3" y="14" width="7" height="7"></rect>
                    </svg>
                </button>
            </div>
        </div>

        <div id="full-image-container"></div>
        <div id="thumbnail-selector" class="visible"></div>
    </div>

    <!-- Metadata Overlay (Moved to root for correct Z-index) -->
    <div id="metadataViewer" class="hidden"></div>

    <!-- Immersive Frame (Independent Viewer) -->
    <iframe id="immersive-frame" class="hidden" src="about:blank"></iframe>

    <!-- Light Pollution Map Overlay (Iframe) -->
    <div id="lightPollutionMapOverlay">
        <div id="lightPollutionMapContainer">
            <iframe id="lightPollutionMapIframe" frameborder="0" scrolling="no"></iframe>
            <button id="lightPollutionMapCloseButton">‚úñÔ∏è</button>
        </div>
    </div>

    <!-- License Overlay (Iframe) -->
    <div id="licenseOverlay" class="hidden">
        <div id="licenseContainer">
            <div class="license-header">
                <h2>License</h2>
                <button id="closeLicense">‚úñÔ∏è</button>
            </div>
            <iframe id="licenseIframe" src="about:blank"></iframe>
        </div>
    </div>

    <!-- App JS -->
    <script type="module" src="js/app.js?v=2"></script>
</body>

</html>